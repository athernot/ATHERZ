<div class="card h-100 product-card shadow-sm border-0">
    <button class="btn wishlist-btn {% if product.id in wishlist_product_ids %}active{% endif %}" data-product-id="{{ product.id }}" title="Add to Wishlist">
        <i class="bi bi-heart-fill"></i>
    </button>
    <a href="{{ url_for('product_detail', product_id=product.id) }}">
        <img src="{{ product.image_url }}" class="card-img-top product-card-img" alt="{{ product.name }}" onerror="this.onerror=null;this.src='https://placehold.co/400x400/EAEAEA/333333?text=Image+Not+Found';">
    </a>
    <div class="card-body d-flex flex-column">
        <h5 class="card-title fw-bold">
            <a href="{{ url_for('product_detail', product_id=product.id) }}" class="text-decoration-none text-body">{{ product.name }}</a>
        </h5>
        <p class="card-text text-muted">{{ product.category }}</p>
        <div class="d-flex align-items-center mb-2">
            <small class="text-warning">
                {% for i in range(1, 6) %}
                    {% if i <= product.average_rating %}<i class="bi bi-star-fill"></i>{% elif i - 0.5 <= product.average_rating %}<i class="bi bi-star-half"></i>{% else %}<i class="bi bi-star"></i>{% endif %}
                {% endfor %}
            </small>
            <small class="text-muted ms-2">({{ product.review_count }})</small>
        </div>
        <p class="card-text fs-5 fw-bold mt-auto">Rp {{ "%.2f"|format(product.price) }}</p>
        <form class="add-to-cart-form">
            <input type="hidden" name="product_id" value="{{ product.id }}">
            <input type="hidden" name="quantity" value="1">
            <button type="submit" class="btn btn-primary w-100 add-to-cart-btn">
                <i class="bi bi-cart-plus-fill"></i> Add to Cart
            </button>
        </form>
    </div>
</div>